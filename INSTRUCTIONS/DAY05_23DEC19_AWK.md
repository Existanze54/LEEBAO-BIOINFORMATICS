# LEEBAO-BIOINFORMATICS

Хакатон по биоинформатике Лаборатории экологии и эволюционной биологии водных организмов ДВФУ

## ДЕНЬ 05. AWK ПАРСИНГ.

## СОДЕРЖАНИЕ

1. [ОПРЕДЕЛЕНИЯ](https://github.com/vinni-bio/LEEBAO-BIOINFORMATICS/blob/master/INSTRUCTIONS/DAY05_23DEC19_AWK.md#1-%D0%BE%D0%BF%D1%80%D0%B5%D0%B4%D0%B5%D0%BB%D0%B5%D0%BD%D0%B8%D1%8F)
2. [СВОЙСТВА AWK](https://github.com/vinni-bio/LEEBAO-BIOINFORMATICS/blob/master/INSTRUCTIONS/DAY05_23DEC19_AWK.md#2-%D1%81%D0%B2%D0%BE%D0%B9%D1%81%D1%82%D0%B2%D0%B0-awk)
3. [СИНТАКСИС AWK](https://github.com/vinni-bio/LEEBAO-BIOINFORMATICS/blob/master/INSTRUCTIONS/DAY05_23DEC19_AWK.md#3-%D1%81%D0%B8%D0%BD%D1%82%D0%B0%D0%BA%D1%81%D0%B8%D1%81-awk)
4. [ОПЦИИ AWK](https://github.com/vinni-bio/LEEBAO-BIOINFORMATICS/blob/master/INSTRUCTIONS/DAY05_23DEC19_AWK.md#4-%D0%BE%D0%BF%D1%86%D0%B8%D0%B8-awk)
5. [РАБОТА с AWK](https://github.com/vinni-bio/LEEBAO-BIOINFORMATICS/blob/master/INSTRUCTIONS/DAY05_23DEC19_AWK.md#5-%D1%80%D0%B0%D0%B1%D0%BE%D1%82%D0%B0-%D1%81-awk)
6. [ПРИМЕРЫ](https://github.com/vinni-bio/LEEBAO-BIOINFORMATICS/blob/master/INSTRUCTIONS/DAY05_23DEC19_AWK.md#6-%D0%BF%D1%80%D0%B8%D0%BC%D0%B5%D1%80%D1%8B)
7. [УПРАЖНЕНИЯ](https://github.com/vinni-bio/LEEBAO-BIOINFORMATICS/blob/master/INSTRUCTIONS/DAY05_23DEC19_AWK.md#7-%D1%83%D0%BF%D1%80%D0%B0%D0%B6%D0%BD%D0%B5%D0%BD%D0%B8%D1%8F)


### 1. ОПРЕДЕЛЕНИЯ

   **Регулярные выражения** – язык поиска шаблонов (англ. pattern – патерн) и осуществление манипуляций с текстовыми (строчными) данными, основанный на использовании специальных метасимволов, включая символы подстановки  

   **Символ подстановки** (англ. wildcard – символ-джокер) – метасимволы, используемые для поиска и замены текстовых (строчных) данных на основе шаблонов  

   **Парсинг** (от англ. parsing - "разбор") – жаргонный термин, который в компьютерной науке обозначает синтаксический анализ текстовых (строчных) типов данных и подобных структур, включая исходные коды различных языков программирования  

   **Команда** – условный термин, обозначающий руководство для действия в различных языках программирования  

   **AWK** – скриптовый язык для анализа текстовых (строчных) данных по заданным шаблонам, включая регулярные выражения  

### 2. СВОЙСТВА AWK

##### A. Операции AWK

     (a) Сканирует файл по строкам  
     (b) Каждую строку разбивает на поля  
     (c) Сравнивает строки или поля с заданными шаблонами  
     (d) Выполняет действия с выбранными строками или полями  

##### B. AWK парсинг

     (a) Преобразование данных  
     (b) Составление текстовых отчетов по заданному формату  

##### С. Возможные операции в AWK

     (a) Создание шаблонов  
     (b) Операции с числовыми и текстовыми данными  
     (с) Условный оператор IF  
     (d) Операторы цикла DO, FOR и WHILE  

### 3. СИНТАКСИС AWK

```
awk опции команды файл
awk '{скрипт}'
awk '{команда1 ; команда2; ...}'
```

### 4. ОПЦИИ AWK

   `-F сепаратор` – сепаратор полей  
   `-f файл` – файл с инструкциями для команд AWK (скрипт)  
   `-v переменная=значение` – определение переменных  

### 5. РАБОТА с AWK

##### Действия

   `BEGIN{...}` – выполнение действия перед чтением файла  
   `{...}` – основное действие при чтении файла  
   `END{...}` – выполнение действия после чтения файла  
   `(...)` – шаблон и условия для выполнения действия  
   `# ...` – комментарии в скрипте AWK  
   `if (условие) действие` – условный оператор  
   `if (условие) действие1 else действие2` – условный оператор  
   `for (вектор) действие` – оператор цикла FOR  
   `for (инициация, условие, инкремент) {действие}` – оператор цикла FOR  
   `while (условие) действие` – оператор цикла WHILE (0+)  
   `do действие while (условие) ` – оператор цикла WHILE (1+)  
   `break` – прерывание цикла  
   `continue` – переход к следующей итерации внутри цикла  
   `next` – переход к следующей итерации внешнего цикла  
   `exit` – выход из программы  

##### Команды

   `{print...}` – вывод данных в консоль  
   `{printf(...)}` – вывод данных в консоль по заданному шаблону  
   `length(строка)` – число символов в строке  
   `gsub(regex,замена)` – число замен во всей строке  
   `gsub(regex,замена,строка)` – число замен в поле/строке  
   `index(строка1,строка1)` – позиция строки1 в строке2  
   `match(строка,regex)` – проверяет есть ли патерн в строке (возвращает индекс или 0)  
   `split(строка,вектор)` – превращает строку в вектор через разделитель FS (возвращает число полей)  
   `split(строка,вектор, fs)` – превращает строку в вектор через разделитель fs (возвращает число полей)  
   `sub(regex, замена)` – заменяет патерн во всей строке (возвращает число замен)  
   `sub(regex, замена, строка)` – заменяет патерн в строке (возвращает число замен)  
   `substr(строка,позиция)` – возвращает символ по позиции в строке  
   `substr(строка,позиция,длина)` – возвращает подстроку заданной длины по начальной позиции в строке  
   `toupper(строка)` – преобразование строки в заглавные символы  
   `tolower(строка)` – преобразование строки в прописные символы  

##### Команды для числовых значений символов (n)

   `int(n)` – округление до целого числа в сторону 0  
   `log(n)` – натуральный логарифм числа  
   `exp(n)` – экспонента числа n  
   `sqrt(n)` – квадратный корень числа  
   `sin(n)` – синус числа  
   `cos(n)` – косинус числа  
   `atan2(m,n)` – арктангенс m / n в радианах  
   `rand(n)` – произвольное число от 0 до 1  
   `srand(n)` – произвольное число из вектора n  

##### Переменные, строки и поля

   `$0` – вся строка  
   `$1` – первое поле в строке  
   `$n` – _n_-е поле в строке  
   `NF` – число полей в строке  
   `$NF` – последнее поле в строке  
   `NR` – общее число прочитанных строк  
   `FS` – сепаратор полей  
   `RS` – сепаратор строк  
   `FILENAME` – имя файла  
   `OFMT` – выходной формат чисел (по умолчанию `%.6g`)  
   `OFS` – выходной разделитель полей  
   `ORS` – выходной разделитель строк  
   `FNR` – порядковый номер строки в файле  
   `RLENGTH` – длина строки, соответствующей шаблону  
   `RSTART` – стартовая позиция строки, соответствующей шаблону  
   `FIELDWIDTHS` – заданная ширина полей  
   `ARGC` – число входных аргументов  
   `ARGV` – вектор входных аргументов  
   `ENVIRON` – переменные среды консоли  
   `/строка/` – строка для сравнения  
   

##### Операторы сравнения

   `>` – больше чем  
   `>=` – больше чем или равно   
   `<` – меньше чем  
   `<=` – меньше чем или равно  
   `==` – равно  
   `!=` – неравно  
   `~` – совпадение символьных строк/полей  
   `!~` – несовпадение символьных строк/полей  

##### Операторы выражений

   `=`,`+=`,`-=`,`*=`,`/=`,`%=`,`^=` – различные операторы присваивания  
   `x?y:z` – если _x_, то _y_, иначе _z_  
   `x || y` – _x_ **ИЛИ** _y_ (возвращает 1, иначе 0)  
   `x && y` – _x_ **И** _y_ (возвращает 1, иначе 0)  
   `x in y` – есть значение вектора `y[x]` (возвращает 1, иначе 0)  
   `x ~ y` – _y_ содержится в _x_ (возвращает 1, иначе 0)  
   `x !~ y` – _y_ не содержится в _x_ (возвращает 1, иначе 0)  
   `x оператор сравнения y` – возвращает 1, иначе 0  
   `!x` – если _x_ равен 0 или пустой (возвращает 1, иначе 0)  
   `"a" "bc"` – конкатенация текстовых данных (`"abc"`)  
   `+` – сложение числовых значений  
   `-` – вычитание числовых значений  
   `/` – деление числовых значений  
   `*` – умножение числовых значений  
   `^` – возведение в степень числовых значений  
   `%` – остаток деления  
   `$i` – вызов переменной `i`  
   `($i)++` – добавление `1` к переменной `i` (инкремент)  

### 6. ПРИМЕРЫ
```
awk 'BEGIN{print "Hello world!"}'			# ПЕЧАТЬ НА ЭКРАН
awk -F: '{print $1}' /etc/passwd			# СМОТРИМ ВСЕ УЧЕТНЫЕ ЗАПИСИ В СИСТЕМЕ
echo "Hello MASHA" | awk '{$2="PETYA"; print $0}'	# ЗАМЕНА В ТЕКСТЕ
echo $PATH | awk -F: '{print $1}'			# ВЫВОД ПЕРВОЙ КОЛОНКИ
awk -F: '{print $1,$NF}' /etc/passwd			# ВЫВОД ПЕРВОЙ И ПОСЛЕДНЕЙ КОЛОНКИ
awk -F: 'BEGIN{OFS="\t"}{print $1,$NF}' /etc/passwd
awk -F: '$5~/Daemon/{print $1}' /etc/passwd		# ВЫВОДИТ СТРОКИ ПО ПАТТЕРНУ
awk 'NR==11, NR==15 {print NR,$0}' /etc/passwd		# ВЫВОД C 11 ПО 15 СТРОКУ
awk 'NR==11, NR==15 {print FILENAMEN,NR,$0}' /etc/passwd
awk 'BEGIN { for (i = 1; i <= 7; i++) print int(101 * rand()) }'	# РАНДОМ
ls -l . | awk '{ x += $5 } ; END{ print "total bytes: " x }'		# РАЗМЕР ФАЙЛОВ В ПАПКЕ
```

### 7. УПРАЖНЕНИЯ

1. Напишите команду AWK, которая преобразует формат *FASTA interleaved* в *FASTA sequential* 
2. Напишите команду AWK, которая преобразует формат *FASTA sequential* в *PHYLYP*
3. Напишите команду AWK, которая преобразует формат *FASTA sequential* в *NEXUS*


